<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Cửa Hàng Tạp Hóa Tài Lộc</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            background-image: url(https://aeros.vn/upload/images/cach-bo-tri-cua-hang-tap-hoa-1.jpg);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        header {
            background-color: #59b63d;
            padding: 20px;
            color: white;
            width: 100%;
            text-align: center;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-sizing: border-box;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-info span {
            font-weight: bold;
        }

        .user-info button {
            background-color: #e74c3c;
            border: none;
            color: white;
            padding: 7px 15px;
            cursor: pointer;
            border-radius: 5px;
        }

        .user-info button:hover {
            background-color: #c0392b;
        }

        .cart button {
            background-color: #008CBA;
            border: none;
            color: white;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
        }

        .cart button:hover {
            background-color: #006994;
        }

        .products {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px;
            max-width: 1000px;
        }

        .product {
            background-color: white;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 200px;
        }

        .product img {
            width: 100%;
            height: auto;
            border-radius: 5px;
        }

        .product button {
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }

        .product button:hover {
            background-color: #45a049;
        }

        .cart-container {
            position: fixed;
            top: 0;
            right: 0;
            width: 30%;
            height: 100%;
            background-color: white;
            padding: 20px;
            box-shadow: -2px 0 5px rgba(0, 0, 0, 0.1);
            display: none;
            overflow-y: auto;
        }

        .cart-container h2 {
            margin-top: 0;
        }

        #cart-items {
            list-style-type: none;
            padding: 0;
        }

        #cart-items li {
            padding: 5px 0;
            border-bottom: 1px solid #ddd;
        }

        #total-price {
            font-size: 18px;
            font-weight: bold;
            margin-top: 20px;
        }

        button {
            cursor: pointer;
        }

        .auth-form {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px #aaa;
            margin-top: 50px;
            width: 300px;
        }

        .auth-form input {
            width: 100%;
            padding: 10px;
            margin: 8px 0;
            box-sizing: border-box;
        }

        .auth-form button {
            width: 100%;
            padding: 10px;
            background-color: #59b63d;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
        }

        .auth-form button:hover {
            background-color: #4a9e2f;
        }

        .hidden {
            display: none;
        }

    </style>
</head>
<body>
    <header>
        <div style="display: flex; align-items: center; gap: 10px;">
            <img src="https://cdn-icons-png.flaticon.com/512/3081/3081648.png" alt="Logo cửa hàng" style="height: 50px;">
            <h1 style="margin: 0;">Cửa Hàng Tạp Hóa Tài Lộc</h1>
        </div>
        <div class="user-info hidden" id="user-info">
            <span>Xin chào bạn đã đến trang mua hàng của Tài Lộc, <span id="user-name"></span></span>
            <button onclick="logout()">Đăng xuất</button>
        </div>
        <div class="cart hidden" id="cart-button">
            <button onclick="viewCart()">Giỏ Hàng (<span id="cart-count">0</span>)</button>
        </div>
    </header>
    
    <!-- Form Đăng nhập -->
    <div class="auth-form" id="login-form">
        <h2>Đăng nhập</h2>
        <input type="text" id="login-username" placeholder="Tên đăng nhập" required />
        <input type="password" id="login-password" placeholder="Mật khẩu" required />
        <button onclick="login()">Đăng nhập</button>
        <p>Chưa có tài khoản? <a href="#" onclick="toggleForms(event)">Đăng ký</a></p>
    </div>

    <!-- Form Đăng ký -->
    <div class="auth-form hidden" id="register-form">
        <h2>Đăng ký</h2>
        <input type="text" id="register-username" placeholder="Tên đăng nhập" required />
        <input type="password" id="register-password" placeholder="Mật khẩu" required />
        <button onclick="register()">Đăng ký</button>
        <p>Đã có tài khoản? <a href="#" onclick="toggleForms(event)">Đăng nhập</a></p>
    </div>

    <!-- Sản phẩm -->
    <section class="products hidden" id="products-section">
        <div class="product">
            <img src="https://media.istockphoto.com/id/1322613316/vi/anh/c%C6%A1m-trong-b%C3%A1t-g%E1%BB%97-tr%C3%AAn-n%E1%BB%81n-c%C6%A1m-v%C3%A0-tai-g%E1%BA%A1o-th%E1%BB%B1c-ph%E1%BA%A9m-t%E1%BB%B1-nhi%C3%AAn-gi%C3%A0u-protein.jpg?s=2048x2048&w=is&k=20&c=KP7_BDuKtmNkMUiiB-Vgo0D4CybR6dXS7WObZ0P7kno=" alt="Gạo Việt" />
            <h3>Gạo Việt</h3>
            <p>Giá: 20.000 VNĐ</p>
            <button onclick="addToCart('Gạo Việt', 20000)">Thêm vào giỏ</button>
        </div>
        <div class="product">
            <img src="https://cdnv2.tgdd.vn/bhx-static/bhx/Products/Images/2565/77622/bhx/slide-1_202410151354441725.jpg" alt="Mì tôm hảo hảo" />
            <h3>Mì tôm hảo hảo</h3>
            <p>Giá: 5.000 VNĐ</p>
            <button onclick="addToCart('Mì tôm hảo hảo', 5000)">Thêm vào giỏ</button>
        </div>
        <div class="product">
            <img src="https://product.hstatic.net/1000284648/product/vinbar_b657d9ee988a42ac9a50eff930e12939.png" alt="Bịch Đường mía Biên Hòa" />
            <h3>Bịch Đường mía Biên Hòa</h3>
            <p>Giá: 10.000 VNĐ</p>
            <button onclick="addToCart('Bịch Đường mía Biên Hòa', 10000)">Thêm vào giỏ</button>
        </div>
        <div class="product">
            <img src="https://product.hstatic.net/1000288770/product/nuoc_tang_luc_sting_huong_dau_chai_dai_thung_24_chai_x_500ml_8aab49e1a07a4c73b9b8f715b3ff4c9c_master.jpg" alt="Thùng Sting Dâu" />
            <h3>Thùng Sting Dâu</h3>
            <p>Giá: 100.000 VNĐ</p>
            <button onclick="addToCart('Thùng Sting Dâu', 100000)">Thêm vào giỏ</button>
        </div>
        <div class="product">
            <img src="https://lh3.googleusercontent.com/WtAxrRgqU2x25u8nBHJCtWL4d-9Q3Y5MIpX0ciNsFTuy7XOnG4JiXGDgwo77DbSL6xoOGMbEtAUpCd-5zlrdX58G3zr7dZLR7Q=rw" alt="Thùng RedBull" />
            <h3>Thùng RedBull</h3>
            <p>Giá: 100.000 VNĐ</p>
            <button onclick="addToCart('Thùng RedBull', 100000)">Thêm vào giỏ</button>
        </div>
    </section>

    <!-- Giỏ hàng -->
    <section class="cart-container" id="cart-container">
        <h2>Giỏ Hàng</h2>
        <ul id="cart-items">
            <!-- Các sản phẩm trong giỏ sẽ xuất hiện ở đây -->
        </ul>
        <p id="total-price">Tổng tiền: 0 VNĐ</p>
        <button onclick="checkout()">Thanh toán</button>
        <button onclick="closeCart()" style="margin-top:10px; background-color:#ccc; color:#333;">Đóng giỏ hàng</button>
    </section>

    <script>
        // Tạo tài khoản lưu trong localStorage theo dạng object {username: password}
        function getUsers() {
            const users = localStorage.getItem('users');
            return users ? JSON.parse(users) : {};
        }

        function saveUsers(users) {
            localStorage.setItem('users', JSON.stringify(users));
        }

        // Kiểm tra trạng thái đăng nhập
        function getCurrentUser() {
            return localStorage.getItem('currentUser');
        }

        function setCurrentUser(username) {
            localStorage.setItem('currentUser', username);
        }

        function clearCurrentUser() {
            localStorage.removeItem('currentUser');
        }

        // Hiển thị UI theo trạng thái đăng nhập
        function updateUI() {
            const currentUser = getCurrentUser();

            if (currentUser) {
                // Hiển thị thông tin người dùng, giỏ hàng, sản phẩm
                document.getElementById('user-info').classList.remove('hidden');
                document.getElementById('user-name').innerText = currentUser;
                document.getElementById('cart-button').classList.remove('hidden');
                document.getElementById('products-section').classList.remove('hidden');

                // Ẩn form đăng nhập và đăng ký
                document.getElementById('login-form').classList.add('hidden');
                document.getElementById('register-form').classList.add('hidden');
            } else {
                // Ẩn thông tin người dùng, giỏ hàng, sản phẩm
                document.getElementById('user-info').classList.add('hidden');
                document.getElementById('cart-button').classList.add('hidden');
                document.getElementById('products-section').classList.add('hidden');

                // Hiển thị form đăng nhập, ẩn form đăng ký
                document.getElementById('login-form').classList.remove('hidden');
                document.getElementById('register-form').classList.add('hidden');

                // Ẩn giỏ hàng nếu đang mở
                closeCart();

                // Reset giỏ hàng
                cart = [];
                cartCount = 0;
                updateCartCount();
            }
        }

        // Đăng ký tài khoản
        function register() {
            const username = document.getElementById('register-username').value.trim();
            const password = document.getElementById('register-password').value.trim();

            if (!username || !password) {
                alert('Vui lòng nhập đầy đủ tên đăng nhập và mật khẩu!');
                return;
            }

            let users = getUsers();

            if (users[username]) {
                alert('Tên đăng nhập đã tồn tại, vui lòng chọn tên khác.');
                return;
            }

            users[username] = password;
            saveUsers(users);
            alert('Đăng ký thành công! Vui lòng đăng nhập.');

            // Chuyển về form đăng nhập
            toggleForms();
        }

        // Đăng nhập tài khoản
        function login() {
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value.trim();

            if (!username || !password) {
                alert('Vui lòng nhập đầy đủ tên đăng nhập và mật khẩu!');
                return;
            }

            let users = getUsers();

            if (users[username] && users[username] === password) {
                setCurrentUser(username);
                alert('Đăng nhập thành công!');
                updateUI();
                resetCart();
            } else {
                alert('Tên đăng nhập hoặc mật khẩu không đúng!');
            }
        }

        // Đăng xuất
        function logout() {
            clearCurrentUser();
            alert('Bạn đã đăng xuất.');
            updateUI();
        }

        // Chuyển đổi giữa form đăng nhập và đăng ký
        function toggleForms(event) {
            if(event) event.preventDefault();
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            loginForm.classList.toggle('hidden');
            registerForm.classList.toggle('hidden');
        }

        // Giỏ hàng xử lý
        let cart = [];
        let cartCount = 0;

        function addToCart(productName, price) {
            cart.push({ productName, price });
            cartCount++;
            updateCartCount();
            alert(productName + " đã được thêm vào giỏ hàng.");
        }

        function updateCartCount() {
            document.getElementById('cart-count').innerText = cartCount;
        }

        function viewCart() {
            if (cart.length === 0) {
                alert("Giỏ hàng của bạn đang trống.");
                return;
            }
            const cartContainer = document.getElementById('cart-container');
            const cartItemsList = document.getElementById('cart-items');
            cartItemsList.innerHTML = ''; // Xóa danh sách cũ

            let totalPrice = 0;
            cart.forEach(item => {
                const listItem = document.createElement('li');
                listItem.innerText = `${item.productName} - ${item.price.toLocaleString()} VNĐ`;
                cartItemsList.appendChild(listItem);
                totalPrice += item.price;
            });

            document.getElementById('total-price').innerText = `Tổng tiền: ${totalPrice.toLocaleString()} VNĐ`;
            cartContainer.style.display = 'block'; // Hiển thị giỏ hàng
        }

        function closeCart() {
            document.getElementById('cart-container').style.display = 'none';
        }

        function checkout() {
            if (cart.length === 0) {
                alert("Giỏ hàng của bạn đang trống.");
                return;
            }

            alert("Cảm ơn bạn đã mua sắm tại cửa hàng tạp hóa của chúng tôi!");
            resetCart();
            closeCart();
        }

        function resetCart() {
            cart = [];
            cartCount = 0;
            updateCartCount();
        }

        // Khi load trang, kiểm tra trạng thái đăng nhập
        window.onload = function () {
            updateUI();
        };
    </script>
</body>
</html>
